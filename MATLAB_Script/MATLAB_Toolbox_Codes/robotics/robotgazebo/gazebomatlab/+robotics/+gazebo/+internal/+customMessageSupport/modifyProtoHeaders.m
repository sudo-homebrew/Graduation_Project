function modifyProtoHeaders(folderPath)
%This function is for internal use only. It may be removed in the future.
%
% This modifies the proto headers generated by protoc such that few classes
% should exported with shared library in windows
% input :
%               @param folderPath              Folder path where generated proto header present

%
%   Copyright 2019-2020 The MathWorks, Inc.

% export definition string
    exportDeclarationString = ['#if defined(_MSC_VER) && defined(PROTOBUF_USE_DLLS)',newline,...
                        '#ifdef CREATE_DLL',newline,...
                        '#define LIBMSGPROTO_EXPORT __declspec(dllexport)',newline,...
                        '#define LIBMSGPROTO_IMPORT __declspec(dllimport)',newline,...
                        '#else',newline,...
                        '#define LIBMSGPROTO_IMPORT __declspec(dllexport)',newline,...
                        '#define LIBMSGPROTO_EXPORT __declspec(dllimport)',newline,...
                        '#endif',newline,...
                        '#else',newline,...
                        '#define LIBMSGPROTO_IMPORT',newline,...
                        '#define LIBMSGPROTO_EXPORT',newline,...
                        '#endif',newline,newline];

    % protobuf generated header list
    protoHeaderList = dir(fullfile(folderPath,'*.pb.h'));

    % create temp folder
    mkdir(fullfile(folderPath,'temp'));

    % create new proto file and add export definition string
    for idx = 1:length(protoHeaderList)
        % open proto header file
        originalProtoFile = fopen(fullfile(folderPath,protoHeaderList(idx).name),'rt');

        % create new proto file into 'temp' folder
        newProtoFile = fopen(fullfile(folderPath,'temp',protoHeaderList(idx).name), 'wt');

        % add export definition string
        fprintf(newProtoFile, '%s\n\n', exportDeclarationString);

        % copy rest of the content of header into new proto file
        while true
            thisline = fgets(originalProtoFile);

            if ~ischar(thisline); break; end   %end of file

            fwrite(newProtoFile, thisline);
        end
        fclose(originalProtoFile);
        fclose(newProtoFile);

        % delete old header file
        delete(fullfile(folderPath,protoHeaderList(idx).name));
        % copy new header file from 'temp' folder to 'protoFiles' folder
        copyfile(fullfile(folderPath,'temp',protoHeaderList(idx).name),fullfile(folderPath,protoHeaderList(idx).name));

    end
    %delete temp folder
    rmdir(fullfile(folderPath,'temp'),'s');

end
